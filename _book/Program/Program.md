# 9.节目文件格式定义

| 参数               | 数据长度 | 默认值 | 描述                                                         |
| ------------------ | -------- | ------ | ------------------------------------------------------------ |
| FileType           | 1        | 0x00   | 文件类型                                                     |
| FileName           | 4        | PXXX   | 文件名XXX为文件编号，ASCII码表示文件名为字符串，发送按顺序发送，如“P123”则先发送‘P’，最后发送‘3’。开机 LOGO 文件名为“LOGO”。 |
| FileLen            | 4        |        | 文件长度                                                     |
| Priority           | 1        | 0x00   | 节目播放优先级                                               |
| DisplayType        | 2        |        | 节目播放方式，0——顺序播放，其他——定长播放的时间，单位为秒    |
| PlayTimes          | 1        |        | 节目重复播放次数                                             |
| ProgramLife        | 8        |        | 节目生命周期，发送顺序为：起始年(2)+起始月(1)+起始日(1)+结束年(2)+结束月(1)+结束日(1)注：1. 时间均采用 BCD 码的方式2. 年范围为 0x1900—0x2099，0xffff 为永久有效，先发送 LSB，后发送 MSB |
| ProgramWeek        | 1        |        | 节目的星期属性1. Bit0 为 1 表示一周中的每一天都播放。2. Bit0 为 0 时，需判断 bit1-bit7 的来决定每天播放，bit1-bit7依次表示周一到周日。3.比特为0表示禁止播放，为 1 表示播放。 |
| ProgramTime        | 1        |        | 定时节目位 0 非定时，注：为 0 时则播放时段组数设置为 0       |
| PlayPeriodGrpNum   | 1        |        | 节目播放时段组数，最多支持一组当为 0 时 PlayPeriodSetting    |
| PlayPeriodSetting0 | 6        |        | 播放组0，发送顺序为：起始小时(1)+起始分钟(1)+起始秒(1)+结束小时(1)+结束分钟(1)+结束秒(1) |
| AreaNum            | 1        |        | 区域个数                                                     |
| AreaDataLen0       | 4        |        | 区域 0 数据长度                                              |
| AreaData0          | N        |        | 区域 0 数据，其数据格式请参考区域数据格式（9.1节）           |
| ......             | ......   | ...... | ......                                                       |
| AreaDataLenN       | 4        |        | 区域 N 数据长度                                              |
| AreaDataN          | N        |        | 区域 N 数据，其数据格式请参考区域数据格式（9.1节）           |
| CHK                | 2        |        | 整个节目文件的 CRC16 校验值（从 FileType 到 AreaDataN），此校验值不可被忽略。 |
#### 示例：

卡型号6K3,128X32屏，手动换行，多行显示，显示内容：“欢迎光临Onbon”，字体大小中文16X16，英文8X16

A5 A5 A5 A5 A5 A5 A5 A5 FE FF 00 80 00 00 00 00 00 00 FE 02 59 00 **A1 06 01 00 00 50 30 30 30 01 00 00 47 00 00 00 00 00 00 50 30 30 30 47 00 00 00 FF 00 00 01 FF FF FF FF FF FF FF FF 01 00 00 01 2C 00 00 00 00 00 80 00 00 80 80 20 00 FF 00 00 00 00 00 00 00 02 02 02 00 0A 0A 0D 00 00 00 BB B6 D3 AD B9 E2 C1 D9 4F 6E 62 6F 6E 0F 18 EC F0** 5A

| 参数             | 数据                                         | 描述                              |
| ---------------- | -------------------------------------------- | --------------------------------- |
| 命令分组         | A1                                           | 动态区更新命令                    |
| 命令编号         | 06                                           | 动态区更新命令                    |
| 控制器是否回复   | 01                                           | 必需要回复                        |
| 保留字节         | 00 00                                        | 2个保留字节                       |
| 文件名           | 30303050                                     | 文件名                            |
| 是否最后一包     | 01                                           | 是否最后一包                      |
| 包号             | 00 00                                        | 包号                              |
| 包长             | 00 47                                        | 包长                              |
| X坐标            | 0000                                         | x轴坐标0                          |
| Y坐标            | 0000                                         | y轴坐标0                          |
| 文件类型         | 00                                           | 文件类型                          |
| 文件名           | 30303050                                     | 文件名                            |
| 文件长度         | 0047                                         | 文件长度                          |
| 节目优先级       | FF                                           | 节目优先级                        |
| 节目播放方式     | 0000                                         | 播放方式                          |
| 节目重复播放次数 | 00 01                                        | 播放次数                          |
| 节目生命周期     | FF FF FF FF FF FF FF FF                      | 生命周期                          |
| 节目星期属性     | 01                                           | 节目星期属性                      |
| 定时节目位       | 00                                           | 定时节目位                        |
| 节目播放时段组数 | 00                                           | 节目播放时段组数                  |
| 区域个数         | 01                                           | 区域个数                          |
| 区域数据长度     | 00 00 00 2C                                  | 区域数据长度                      |
| 区域类型         | 00                                           | 区域类型                          |
| X坐标            | 80 00                                        | 坐标0（高字节在前，像素点为单位） |
| Y坐标            | 00 00                                        | 坐标0                             |
| 区域宽度         | 80 80                                        | 区域宽度128，像素点为单位         |
| 区域高度         | 00 20                                        | 区域高度32，像素点为单位          |
| 区域编号         | FF                                           | 区域编号                          |
| 行间距           | 00                                           | 行间距                            |
| 区运行模式       | 00                                           | 区运行模式                        |
| 区超时时间       | 0000                                         | 超时时间                          |
| 是否使能语音     | 00                                           | 是否使能语音                      |
| 扩展位个数       | 00                                           | 扩展位个数                        |
| 字对齐           | 00                                           | 字对齐方式                        |
| 是否单行显示     | 02                                           | 多行显示                          |
| 是否自动换行     | 02                                           | 自动换行                          |
| 显示方式         | 02                                           | 显示方式                          |
| 退出方式         | 00                                           | 退出方式                          |
| 显示速度         | 0A                                           | 显示速度                          |
| 停留时间         | 0A                                           | 停留时间                          |
| 显示数据长度     | 0D 00 00 00                                  | 显示数据长度                      |
| 显示数据         | BB B6 D3 AD B9 E2 C1 D9 4F 6E 62 6F 6E 0F 18 | 欢迎光临Onbon                     |
| CRC校验          | EC F0                                        | CRC校验                           |


### 9.1  区域数据格式

| 参数           | 数据长度 | 默认值 | 描述                                                         |
| -------------- | -------- | ------ | ------------------------------------------------------------ |
| AreaType       | 1        | 0x00   | 区域类型                                                     |
| AreaX          | 2        |        | 区域 X 坐标，以字节(8 个像素点)为单位                        |
| AreaY          | 2        |        | 区域 Y 坐标，以像素点为单位                                  |
| AreaWidth      | 2        |        | 区域宽度，以字节(8 个像素点)为单位                           |
| AreaHeight     | 2        |        | 区域高度，以像素点为单位                                     |
| DynamicAreaLoc | 1        | 0xFF   | 动态区域编号,注意：该参数只对动态区有效，其他区域为默认值，动态区必须统一编号，编号从 0 开始递增。 |
| Lines_sizes    | 1        |        | 行间距                                                       |
| RunMode        | 1        |        | RunMode动态区运行模式,0—动态区数据循环显示。1—动态区数据显示完成后静止显示最后一页数据。2— 动态区数据循环显示，超过设定时间后数据仍未更新时删除动态区信息。 |
| Timeout        | 2        |        | 动态区数据超时时间，单位为秒                                 |
| SoundMode      | 1        |        | 是否使能语音播放,0 表示不使能语音,1 表示播放下文中 Data 部分内容,2 表示播放下文中 SoundData 部分内容 |
| SoundPerson    | 1        | 0      | 发音人，0~5，共 6 种。当 SoundMode不为0时才发送该字节，否则不发送 |
| SoundVolume    | 1        | 5      | 音量，0~10，共11种，0表示静音。当SoundMode不为0时才发送该字节，否则不发送 |
| SoundSpeed     | 1        | 5      | 语速，0~10，共 10 种。当 SoundMode 不为 0 时才发送该字节，否则不发送 |
| SoundDataLen   | 4        |        | 当 SoundMode 为 2 时，才发送该部分内容。表示 SoundData部分数据长度 |
| SoundData      | N        |        | 当 SoundMode为2时，才发送该部分内容，否则不发送，具体格式请参考下文中 Data 的格式 |
| ExtendParaLen  | 1        | N      | 拓展位个数,如： 0x0A,则拓展位为 10 位                        |
| TypeSetting    | 1        | 0x00   | 排 版 方 式 （ 上 下 左 右 有 优 先 级 ）当 ExtendParaLen > 0，才发送该字节，否则不发送0：表示先从左往右，再从上往下1：表示先从右往左，再从上往下2：表示先从上往下，再从左往右3：表示先从上往下，再从右往左 |
| Font_sizes     | 1        |        | 字间距 ，当  ExtendParaLen > 1时才发送，字间距，像素点为单位 |
| Reserved       | N-1      | 0x00   | 拓展保留位，当 ExtendParaLen > 1，才发送，否则不发送根据 ExtendParaLen 数值大小确定长度 |
| TypeSetting    | 1        | 0x00   | 字体对齐方式，Bit1  Bit0： 00左对齐，01右对齐，10居中        |
| SingleLine     | 1        | 0x02   | 是否单行显示,0x01——单行显示,0x02——多行显示                   |
| NewLine        | 1        |        | 是否自动换行,0x01——不自动换行，显示数据在换行时必须插入换行符,0x02——自动换行，显示内容不需要换行符，但是只能使用统一的中文字体和英文字体 |
| DisplayMode    | 1        |        | 显示方式，其定义如下：0x01——静止显示,0x02——快速打出,0x03——向左移动,0x04——向右移动,0x05——向上移动,0x06——向下移动 |
| ExitMode       | 1        | 0x00   | 退出方式                                                     |
| Speed          | 1        |        | 显示速度，定义如下：0x00——最快,0x01——......0x17——0x18 ——最慢 |
| StayTime       | 1        |        | 显示特技停留时间，单位为 0.5s                                |
| DataLen        | 4        |        | 数据长度（包括换行，颜色等转义参数）                         |
| Data           | N        |        | 显示数据，即用户需显示的内容，包括所有特殊字符（请参考“图文区内容编辑”一章） |
#### 示例：

卡型号6K3,128X32屏，手动换行，多行显示，显示内容：“欢迎光临Onbon”，字体大小中文16X16，英文8X16

A5 A5 A5 A5 A5 A5 A5 A5 FE FF 00 80 00 00 00 00 00 00 FE 02 59 00 **A1 06 01 00 00 50 30 30 30 01 00 00 47 00 00 00 00 00 00 50 30 30 30 47 00 00 00 FF 00 00 01 FF FF FF FF FF FF FF FF 01 00 00 01 2C 00 00 00 00 00 80 00 00 80 80 20 00 FF 00 00 00 00 00 00 00 02 02 02 00 0A 0A 0D 00 00 00 BB B6 D3 AD B9 E2 C1 D9 4F 6E 62 6F 6E 0F 18 EC F0** 5A

| 参数             | 数据                                         | 描述                              |
| ---------------- | -------------------------------------------- | --------------------------------- |
| 命令分组         | A1                                           | 动态区更新命令                    |
| 命令编号         | 06                                           | 动态区更新命令                    |
| 控制器是否回复   | 01                                           | 必需要回复                        |
| 保留字节         | 00 00                                        | 2个保留字节                       |
| 文件名           | 30303050                                     | 文件名                            |
| 是否最后一包     | 01                                           | 是否最后一包                      |
| 包号             | 00 00                                        | 包号                              |
| 包长             | 00 47                                        | 包长                              |
| X坐标            | 0000                                         | x轴坐标0                          |
| Y坐标            | 0000                                         | y轴坐标0                          |
| 文件类型         | 00                                           | 文件类型                          |
| 文件名           | 30303050                                     | 文件名                            |
| 文件长度         | 0047                                         | 文件长度                          |
| 节目优先级       | FF                                           | 节目优先级                        |
| 节目播放方式     | 0000                                         | 播放方式                          |
| 节目重复播放次数 | 00 01                                        | 播放次数                          |
| 节目生命周期     | FF FF FF FF FF FF FF FF                      | 生命周期                          |
| 节目星期属性     | 01                                           | 节目星期属性                      |
| 定时节目位       | 00                                           | 定时节目位                        |
| 节目播放时段组数 | 00                                           | 节目播放时段组数                  |
| 区域个数         | 01                                           | 区域个数                          |
| 区域数据长度     | 00 00 00 2C                                  | 区域数据长度                      |
| 区域类型         | 00                                           | 区域类型                          |
| X坐标            | 80 00                                        | 坐标0（高字节在前，像素点为单位） |
| Y坐标            | 00 00                                        | 坐标0                             |
| 区域宽度         | 80 80                                        | 区域宽度128，像素点为单位         |
| 区域高度         | 00 20                                        | 区域高度32，像素点为单位          |
| 区域编号         | FF                                           | 区域编号                          |
| 行间距           | 00                                           | 行间距                            |
| 区运行模式       | 00                                           | 区运行模式                        |
| 区超时时间       | 0000                                         | 超时时间                          |
| 是否使能语音     | 00                                           | 是否使能语音                      |
| 扩展位个数       | 00                                           | 扩展位个数                        |
| 字对齐           | 00                                           | 字对齐方式                        |
| 是否单行显示     | 02                                           | 多行显示                          |
| 是否自动换行     | 02                                           | 自动换行                          |
| 显示方式         | 02                                           | 显示方式                          |
| 退出方式         | 00                                           | 退出方式                          |
| 显示速度         | 0A                                           | 显示速度                          |
| 停留时间         | 0A                                           | 停留时间                          |
| 显示数据长度     | 0D 00 00 00                                  | 显示数据长度                      |
| 显示数据         | BB B6 D3 AD B9 E2 C1 D9 4F 6E 62 6F 6E 0F 18 | 欢迎光临Onbon                     |
| CRC校验          | EC F0                                        | CRC校验                           |

### 9.2  多分区节目文件实例分析
#### 示例：

卡型号6K3,128X32屏，手动换行，多行显示，区域1，起始坐标（0,0）显示内容：“欢迎光临”，字体大小中文16X16，区域2，起始坐标（0,16）显示内容：“1234”，字体大小英文8X16

A5 A5 A5 A5 A5 A5 A5 A5 01 00 00 80 00 00 00 00 00 00 63 02 77 00 **A1 06 01 00 00 50 30 30 30 01 00 00 65 00 00 00 00 00 00 50 30 30 30 65 00 00 00 FF 00 00 01 FF FF FF FF FF FF FF FF 01 00 00 02 27 00 00 00 00 00 80 00 00 80 80 10 00 FF 00 00 00 00 00 00 00 02 02 03 00 0A 0A 08 00 00 00 BB B6 D3 AD B9 E2 C1 D9 23 00 00 00 00 00 80 10 00 80 80 10 00 FF 00 00 00 00 00 00 00 02 02 03 00 0A 0A 04 00 00 00 31 32 33 34 8A EC** F7 4C 5A

| 参数             | 数据                    | 描述                              |
| ---------------- | ----------------------- | --------------------------------- |
| 命令分组         | A1                      | 动态区更新命令                    |
| 命令编号         | 06                      | 动态区更新命令                    |
| 控制器是否回复   | 01                      | 必需要回复                        |
| 保留字节         | 00 00                   | 2个保留字节                       |
| 文件名           | 30303050                | 文件名                            |
| 是否最后一包     | 01                      | 是否最后一包                      |
| 包号             | 00 00                   | 包号                              |
| 包长             | 00 65                   | 包长                              |
| X坐标            | 0000                    | x轴坐标0                          |
| Y坐标            | 0000                    | y轴坐标0                          |
| 文件类型         | 00                      | 文件类型                          |
| 文件名           | 30303050                | 文件名                            |
| 文件长度         | 0065                    | 文件长度                          |
| 节目优先级       | FF                      | 节目优先级                        |
| 节目播放方式     | 0000                    | 播放方式                          |
| 节目重复播放次数 | 01                      | 播放次数                          |
| 节目生命周期     | FF FF FF FF FF FF FF FF | 生命周期                          |
| 节目星期属性     | 01                      | 节目星期属性                      |
| 定时节目位       | 00                      | 定时节目位                        |
| 节目播放时段组数 | 00                      | 节目播放时段组数                  |
| 区域个数         | 02                      | 区域个数                          |
| 区域0数据长度    | 00 00 00 27             | 区域数据长度                      |
| 区域类型         | 00                      | 区域类型                          |
| X坐标            | 80 00                   | 坐标0（高字节在前，像素点为单位） |
| Y坐标            | 00 00                   | 坐标0                             |
| 区域宽度         | 80 80                   | 区域宽度128，像素点为单位         |
| 区域高度         | 00 10                   | 区域高度32，像素点为单位          |
| 区域编号         | FF                      | 区域编号                          |
| 行间距           | 00                      | 行间距                            |
| 区运行模式       | 00                      | 区运行模式                        |
| 区超时时间       | 0000                    | 超时时间                          |
| 是否使能语音     | 00                      | 是否使能语音                      |
| 扩展位个数       | 00                      | 扩展位个数                        |
| 字对齐           | 00                      | 字对齐方式                        |
| 是否单行显示     | 02                      | 多行显示                          |
| 是否自动换行     | 02                      | 自动换行                          |
| 显示方式         | 03                      | 显示方式                          |
| 退出方式         | 00                      | 退出方式                          |
| 显示速度         | 0A                      | 显示速度                          |
| 停留时间         | 0A                      | 停留时间                          |
| 显示数据长度     | 0D 00 00 08             | 显示数据长度                      |
| 显示数据         | BB B6 D3 AD B9 E2 C1 D9 | 欢迎光临                          |
| 区域1数据长度    | 00 00 00 23             | 区域数据长度                      |
| 区域类型         | 00                      | 区域类型                          |
| X坐标            | 80 00                   | 坐标0（高字节在前，像素点为单位） |
| Y坐标            | 00 10                   | 坐标0                             |
| 区域宽度         | 80 80                   | 区域宽度128，像素点为单位         |
| 区域高度         | 00 10                   | 区域高度32，像素点为单位          |
| 区域编号         | FF                      | 区域编号                          |
| 行间距           | 00                      | 行间距                            |
| 区运行模式       | 00                      | 区运行模式                        |
| 区超时时间       | 0000                    | 超时时间                          |
| 是否使能语音     | 00                      | 是否使能语音                      |
| 扩展位个数       | 00                      | 扩展位个数                        |
| 字对齐           | 00                      | 字对齐方式                        |
| 是否单行显示     | 02                      | 多行显示                          |
| 是否自动换行     | 02                      | 自动换行                          |
| 显示方式         | 03                      | 显示方式                          |
| 退出方式         | 00                      | 退出方式                          |
| 显示速度         | 0A                      | 显示速度                          |
| 停留时间         | 0A                      | 停留时间                          |
| 显示数据长度     | 0D 00 00 04             | 显示数据长度                      |
| 显示数据         | 31 32 33 34             | 欢迎光临                          |
| CRC校验          | 8A EC                   | CRC校验                           |